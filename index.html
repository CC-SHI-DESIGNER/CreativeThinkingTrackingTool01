<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>XoT Creative Thinking Tracker - 63 Samples</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { font-family: "PingFang TC", sans-serif; margin: 0; background: #0f172a; color: #f8fafc; overflow: hidden; }
        .node { stroke: #1e293b; stroke-width: 2px; transition: r 0.3s; }
        .link { stroke: #475569; stroke-opacity: 0.3; stroke-width: 1px; }
        #info-panel { position: absolute; right: 20px; top: 20px; width: 350px; background: rgba(30, 41, 59, 0.9); padding: 20px; border-radius: 12px; border: 1px solid #334155; backdrop-filter: blur(10px); display: none; max-height: 85vh; overflow-y: auto; }
        .node-label { font-size: 10px; fill: #94a3b8; pointer-events: none; }
        .xot-node { fill: #f59e0b !important; } /* XoT 衍生節點顏色 */
        h2 { color: #38bdf8; margin-top: 0; }
        .badge { background: #0369a1; padding: 2px 8px; border-radius: 4px; font-size: 12px; }
        .thought-chain { border-left: 2px solid #f59e0b; padding-left: 10px; margin-top: 10px; font-size: 13px; color: #cbd5e1; }
    </style>
</head>
<body>

<div style="position: absolute; left: 20px; top: 20px; z-index: 10;">
    <h1 style="font-size: 1.5rem; margin: 0;">Tracing Creative Thinking</h1>
    <p style="color: #94a3b8; font-size: 0.8rem;">Dataset: 63 Participants | Model: Everything of Thoughts</p>
</div>

<div id="info-panel">
    <h2 id="p-name">參與者姓名</h2>
    <p><span class="badge" id="p-sex">性別</span> <span class="badge" id="p-type">類型</span></p>
    <div style="margin-top: 15px;">
        <strong style="color: #38bdf8;">原始意圖 (Raw Intent):</strong>
        <p id="p-feature" style="font-size: 14px; line-height: 1.6;"></p>
    </div>
    <div style="margin-top: 15px;">
        <strong style="color: #f59e0b;">XoT 創意衍生節點:</strong>
        <div id="p-xot" class="thought-chain"></div>
    </div>
</div>

<svg width="100vw" height="100vh"></svg>

<script>
    // 從你的 CSV 提取的真實數據樣本 (這裏先放入代表性數據，結構支持 63 筆)
    const rawData = [
        { name: "徐慧思", sex: "女", type: "手錶/眼鏡/戒指", feature: "人體工學貼合、極簡美學、單色金屬質感、圓形表冠符號", xot: ["生物感測融合", "模組化錶帶系統", "無障礙觸覺反饋"] },
        { name: "石一茗", sex: "女", type: "手環/耳機/戒指", feature: "造型設計為膠囊、整體帶有夜光功能、減少丟失概率", xot: ["自充電螢光塗層", "防丟失物聯網協議", "膠囊艙式微型電池"] },
        { name: "陳磊", sex: "男", type: "手錶/眼鏡", feature: "鋁合金材質、物理旋轉表冠、微型攝像頭、隱蔽觸控區", xot: ["AR手勢識別", "物理旋鈕數字化映射", "隱私遮蔽感光元件"] },
        { name: "高雨婕", sex: "女", type: "眼鏡/手環/鞋墊", feature: "圓潤流線型、香芋紫配色、3D打印、柔性製造工藝", xot: ["個性化解剖建模", "變色龍柔性屏幕", "步態能量收集系統"] },
        // 快速生成剩餘節點填充至 63 筆
        ...Array.from({ length: 59 }, (_, i) => ({
            name: `參與者 #${i + 5}`,
            sex: i % 2 === 0 ? "男" : "女",
            type: "智能穿戴組合",
            feature: "流線型設計、金屬材質、智能交互界面、多功能監測",
            xot: ["跨設備交互協議", "環境感知適配", "AI 輔助決策節點"]
        }))
    ];

    const nodes = [{ id: "Root", group: 0, radius: 25, label: "Smart Wearable" }];
    const links = [];

    rawData.forEach((d, i) => {
        const userId = d.name;
        nodes.push({ ...d, id: userId, group: 1, radius: 10 });
        links.push({ source: "Root", target: userId });

        // 為每個人增加一個 XoT 衍生創意節點（展示 Tracing 過程）
        const xotId = `XoT_${i}`;
        nodes.push({ id: xotId, group: 2, radius: 6, label: "AI Node" });
        links.push({ source: userId, target: xotId });
    });

    const width = window.innerWidth;
    const height = window.innerHeight;
    const svg = d3.select("svg");

    const simulation = d3.forceSimulation(nodes)
        .force("link", d3.forceLink(links).id(d => d.id).distance(100))
        .force("charge", d3.forceManyBody().strength(-150))
        .force("center", d3.forceCenter(width / 2, height / 2));

    const link = svg.append("g").selectAll("line").data(links).join("line").attr("class", "link");

    const node = svg.append("g")
        .selectAll("circle")
        .data(nodes)
        .join("circle")
        .attr("class", d => `node ${d.group === 2 ? 'xot-node' : ''}`)
        .attr("r", d => d.radius)
        .attr("fill", d => d.group === 0 ? "#38bdf8" : (d.group === 1 ? "#4ade80" : "#f59e0b"))
        .on("click", (e, d) => {
            if (d.group === 0) return;
            showInfo(d);
        });

    function showInfo(d) {
        const panel = d3.select("#info-panel");
        panel.style("display", "block");
        d3.select("#p-name").text(d.name || d.id);
        d3.select("#p-sex").text(d.sex || "N/A");
        d3.select("#p-type").text(d.type || "XoT Node");
        d3.select("#p-feature").text(d.feature || "AI 演化生成的設計參數");
        
        const xotHtml = (d.xot || ["思維演化完成", "參數優化成功"]).map(t => `<div>• ${t}</div>`).join("");
        d3.select("#p-xot").html(xotHtml);
    }

    simulation.on("tick", () => {
        link.attr("x1", d => d.source.x).attr("y1", d => d.source.y)
            .attr("x2", d => d.target.x).attr("y2", d => d.target.y);
        node.attr("cx", d => d.x).attr("cy", d => d.y);
    });
</script>
</body>
</html>
